!function(e){e.fn.yiiGridView=function(i){return o[i]?o[i].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof i&&i?(e.error("Method "+i+" does not exist in jQuery.yiiGridView"),!1):o.init.apply(this,arguments)};var i={filterUrl:void 0,filterSelector:void 0,filterOnFocusOut:!0},t={},r={beforeFilter:"beforeFilter",afterFilter:"afterFilter"},n={},o={init:function(r){return this.each(function(){var n=e(this),a=e.extend({},i,r||{}),c=n.attr("id");void 0===t[c]&&(t[c]={}),t[c]=e.extend(t[c],{settings:a});var f=!1;l(n,"filter","change.yiiGridView keydown.yiiGridView",a.filterSelector,function(e){if("keydown"===e.type){if(13!==e.keyCode)return;f=!0}else if(f)return void(f=!1);return!(!a.filterOnFocusOut&&"keydown"!==e.type)&&(o.applyFilter.apply(n),!1)})})},applyFilter:function(){var i=e(this),n=t[i.attr("id")].settings,o={};e.each(e(n.filterSelector).serializeArray(),function(){this.name in o||(o[this.name]=[]),o[this.name].push(this.value)});var l=Object.keys(o);e.each(yii.getQueryParams(n.filterUrl),function(i,t){-1===l.indexOf(i)&&-1===l.indexOf(i.replace(/\[\d*\]$/,""))&&(e.isArray(t)||(t=[t]),i in o?e.each(t,function(t,r){e.inArray(r,o[i])&&o[i].push(r)}):o[i]=t)});var a=n.filterUrl.indexOf("?"),c=a<0?n.filterUrl:n.filterUrl.substring(0,a),f=n.filterUrl.indexOf("#");a>=0&&f>=0&&(c+=n.filterUrl.substring(f)),i.find("form.gridview-filter-form").remove();var d=e("<form/>",{action:c,method:"get",class:"gridview-filter-form",style:"display:none","data-pjax":""}).appendTo(i);e.each(o,function(i,t){e.each(t,function(t,r){d.append(e("<input/>").attr({type:"hidden",name:i,value:r}))})});var s=e.Event(r.beforeFilter);i.trigger(s),!1!==s.result&&(d.submit(),i.trigger(r.afterFilter))},setSelectionColumn:function(i){var r=e(this),n=e(this).attr("id");if(void 0===t[n]&&(t[n]={}),t[n].selectionColumn=i.name,i.multiple&&i.checkAll){var o="#"+n+" input[name='"+i.checkAll+"']",a=i.class?"input."+i.class:"input[name='"+i.name+"']",c="#"+n+" "+a+":enabled";l(r,"checkAllRows","click.yiiGridView",o,function(){r.find(a+":enabled").prop("checked",this.checked).change()}),l(r,"checkRow","click.yiiGridView",c,function(){var e=r.find(a).length==r.find(a+":checked").length;r.find("input[name='"+i.checkAll+"']").prop("checked",e).change()})}},getSelectedRows:function(){var i=e(this),r=t[i.attr("id")],n=[];return r.selectionColumn&&i.find("input[name='"+r.selectionColumn+"']:checked").each(function(){n.push(e(this).parent().closest("tr").data("key"))}),n},destroy:function(){var i=[".yiiGridView",r.beforeFilter,r.afterFilter].join(" ");this.off(i);var o=e(this).attr("id");return e.each(n[o],function(i,t){e(document).off(t.event,t.selector)}),delete t[o],this},data:function(){var i=e(this).attr("id");return t[i]}};function l(i,t,r,o,l){var a=i.attr("id"),c=n[a];if(void 0!==c&&void 0!==c[t]){var f=c[t];e(document).off(f.event,f.selector)}void 0===c&&(n[a]={}),e(document).on(r,o,l),n[a][t]={event:r,selector:o}}}(window.jQuery);